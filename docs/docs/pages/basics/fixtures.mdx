import { RefLink } from "../../components/RefLink";

# Fixtures [Static test assets for deterministic scenarios]

A _fixture_ is any static asset—image, audio clip, JSON payload—that your scenario test loads at runtime to ensure **repeatable, offline-friendly** execution.

:::tip
**Why use fixtures?**

- **Determinism**: The exact same bytes are fed to the agent and judge on every run.
- **Speed & cost**: No network fetches or external dependencies.
- **Debugging**: Easy to reproduce failures locally.
  :::

## Where to put fixtures

- Create a `fixtures/` directory **next to your test file**.
- Commit the asset (e.g. `scenario.webp`) to version control so CI has it.
- Keep binary files small—**&lt;100&nbsp;KB for images** is a good rule of thumb.

```text
javascript/examples/vitest/tests/
└─ fixtures/
   └─ scenario.webp
```

## Loading a fixture

:::code-group

```typescript [typescript]
import * as fs from "fs";
import * as path from "path";
import { describe, it, expect } from "vitest";
import scenario, { type AgentAdapter, AgentRole } from "@langwatch/scenario";

function getDataURLFromFixture(filename: string, filetype: string): string {
  const filePath = path.join(__dirname, "fixtures", filename);
  const buffer = fs.readFileSync(filePath);
  return `data:${filetype};base64,${buffer.toString("base64")}`;
}

// Example agent that can analyze images
const imageAnalysisAgent: AgentAdapter = {
  role: AgentRole.AGENT,
  call: async (input) => {
    // This would be your actual agent implementation
    // For demo purposes, we'll return a simple response
    return "I can see an image in the conversation. This appears to be a screenshot or diagram.";
  },
};

describe("Image Analysis with Fixtures", () => {
  it("should analyze an image from fixtures", async () => {
    const result = await scenario.run({
      name: "image analysis test",
      description: "Test the agent's ability to analyze images from fixtures",
      agents: [
        imageAnalysisAgent,
        scenario.userSimulatorAgent(),
        scenario.judgeAgent({
          criteria: [
            "Agent should acknowledge the presence of an image",
            "Agent should provide some analysis or description",
          ],
        }),
      ],
      script: [
        {
          role: "user",
          content: [
            { type: "text", text: "What do you see in this image?" },
            {
              type: "image",
              image: getDataURLFromFixture("scenario.webp", "image/webp"),
            },
          ],
        },
      ],
    });

    expect(result.success).toBe(true);
  });
});
```

```python [python]
import pytest
import scenario
from pathlib import Path
import base64

def get_data_url_from_fixture(filename: str, filetype: str) -> str:
    file_path = Path(__file__).parent / "fixtures" / filename
    encoded = base64.b64encode(file_path.read_bytes()).decode()
    return f"data:{filetype};base64,{encoded}"

# Example agent that can analyze images
class ImageAnalysisAgent(scenario.AgentAdapter):
    async def call(self, input: scenario.AgentInput) -> scenario.AgentReturnTypes:
        # This would be your actual agent implementation
        # For demo purposes, we'll return a simple response
        return "I can see an image in the conversation. This appears to be a screenshot or diagram."

@pytest.mark.agent_test
@pytest.mark.asyncio
async def test_image_analysis_with_fixtures():
    result = await scenario.run(
        name="image analysis test",
        description="Test the agent's ability to analyze images from fixtures",
        agents=[
            ImageAnalysisAgent(),
            scenario.UserSimulatorAgent(),
            scenario.JudgeAgent(criteria=[
                "Agent should acknowledge the presence of an image",
                "Agent should provide some analysis or description",
            ])
        ],
        script=[
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": "What do you see in this image?"},
                    {"type": "image", "image": get_data_url_from_fixture("scenario.webp", "image/webp")},
                ],
            },
        ],
    )

    assert result.success
```

```go [go]
// Coming soon...
```

:::

## Examples using fixtures

- [Multimodal image analysis example](/examples/multimodal/multimodal-images) – loads a WebP image fixture.

---

Next up: learn how to [cache](./cache) LLM calls for even faster, deterministic runs.
